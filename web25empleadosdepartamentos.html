<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <style>
            table {
                border: 2px solid black;
                border-collapse: collapse;
            }
            th,
            td {
                border: 1px solid black;
            }
        </style>
    </head>
    <body>
        <h1>Maestro detalle empledos departamentos</h1>
        <ul id="listadepartamentos"></ul>
        <table id="tablaempleados"></table>
        <script src="js/jquery-3.7.1.js"></script>
        <script>
            let urlempleados = "https://apiempleadosspgs.azurewebsites.net/api/Empleados/EmpleadosDepartamento/";
            let urldepartamentos = "https://apicruddepartamentospgs.azurewebsites.net/webresources/departamentos";
            $(document).ready(function () {
                getDepartamentos();
            });
            function getDepartamentos() {
                $.getJSON(urldepartamentos, function (data) {
                    let html = "";
                    $.each(data, function (index, departamento) {
                        html += "<li>" + departamento.nombre + "<button value='" + departamento.numero + "'>Empleados</button></li>";
                    });
                    $("#listadepartamentos").html(html);
                    $("button").click(function () {
                        boton($(this).val());
                    });
                });
            }
            function boton(idDepartamento) {
                $.getJSON(urlempleados + idDepartamento, function (data) {
                    let html = `
                                <thead>
                                    <tr>
                                        <th>Apellido</th>
                                        <th>Oficio</th>
                                        <th>Salario</th>
                                        <th>Departamento</th>
                                    </tr>
                                </thead>
                                <tbody>
                                `;
                    $.each(data, function (index, empleado) {
                        html += "<tr>";
                        html += "<td>" + empleado.apellido + "</td>";
                        html += "<td>" + empleado.oficio + "</td>";
                        html += "<td>" + empleado.salario + "</td>";
                        html += "<td>" + empleado.departamento + "</td>";
                        html += "</tr>";
                    });
                    html += "</tbody>";
                    $("#tablaempleados").html(html);
                });
            }
        </script>
    </body>
</html>
